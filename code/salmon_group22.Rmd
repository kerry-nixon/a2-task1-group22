---
title: "Adult Salmon Passage"
author: "Kerry Nixon, Kelsie Fronheiser, Shelby Walsh"
date: "2/1/2021"
output: 
  html_document:
    theme: darkly
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, error = FALSE, message = FALSE)

library(tidyverse)
library(janitor)
library(here)
library(tidyr)
library(lubridate)
library(tsibble)
library(feasts)
library(colorspace)
library(RColorBrewer)
```
# Overview {.tabset}


This data set used in this report was accessed from [Columbia River DART](http://www.cbr.washington.edu/dart) and includes counts of adult fish passages through the Willamette Falls fish ladder between January 1, 2001 and December 31, 2010. This report focuses on adult and jack Coho salmon (*Oncorhynchus kisutch*) and Steelhead Trout (*Oncorhynchus mykiss*). The results of the report display time series and season plots of Coho and Steelhead fish passages through Willamette Falls, as well as annual totals per species.
```{r}
full_fish <- read_csv(here("data", "willamette_fish_passage.csv"))
```
## Time Series
```{r}
# Data wrangling
fish <- full_fish %>% 
  select("Project", "Date", "Steelhead","Coho","Jack Coho")

fish_ts <- fish %>% 
  mutate(Date = lubridate::mdy(Date)) %>% 
  as_tsibble(key = NULL, index = Date)

# Exploratory graph
ggplot(data = fish_ts, aes(x = Date, y = Steelhead)) +
  geom_point()
```

<<<<<<< HEAD

=======

## Seasonplots
```{r}
#trying to out a ggseason just to explore
fish_ts_season <- fish_ts %>% 
  clean_names() %>% 
  pivot_longer(
    cols = steelhead:jack_coho,
    names_to = "species",
    values_to = "count"
  ) %>% 
  mutate(count = replace_na(count, 0))
  

fish_ts_season %>% 
  gg_season(y = count) +
  facet_wrap(~ species) +
  theme_minimal() +
  labs(x = "Month",
       y = "Number of Fish Observed ", 
       title = "Seasonal Salmon Observations at the Willamette Falls\n Fish Ladder")

steel <- fish_ts_season %>% 
  filter(species == "steelhead")

steel_plot <- 
  gg_season(data = steel, y = count, pal = heat_hcl(9, l=c(80, 30), c=c(30,90), power = c(1/5, 1.5))) +
  theme_minimal()

steel_plot


coho <- fish_ts_season %>% 
  filter(species == "coho") 


coho_plot <- 
  gg_season(data = coho, y = count, pal = heat_hcl(9, h =c(0,-70), l=c(75, 40), c=c(40,80), power = 1)) +
  theme_minimal()

coho_plot

jack_coho <- fish_ts_season %>% 
  filter(species == "jack_coho") 


jack_coho_plot <- 
  gg_season(data = jack_coho, y = count, pal = heat_hcl(9, c=c(80, 30), l=c(30,90), power = c(1/5, 1.5))) +
  theme_minimal()

jack_coho_plot
```

- Steelhead salmon were 
- coho = september through november observed. Increasing over years
- Jack coho = late september though october, most centralized but least observed



## Summary Statistics & Analysis
>>>>>>> origin
